!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}({3:function(e,t,r){e.exports=r(8)},8:function(e,t,r){"use strict";r.r(t),window.OPC_RESOURCE_LIST={};var o=1,n={actHost:window.location.href.indexOf("cloud.tencent.com")>0?"cloud.tencent.com":"qcloud.com",is_preview:/(\?|\&)\!preview$/.test(window.location.href),opcHost:window.location.href.indexOf("cloud.tencent.com")>0?"opc.cloud.tencent.com":"opc.qcloud.com",consoleMessageSid:"lAXbCZ",isGetResourceListLoading:!1,isConsoleIframeRender:!1,iframeSelector:null,currentPagePath:"",isLtIE9:/msie [\w.]+/.test(navigator.userAgent.toLowerCase())&&(!document.documentMode||document.documentMode<=9),init:function(e){if(window.LOGIN_INFO&&1!==window.LOGIN_INFO.area)return!1;var t=this.getResourceDom(e);this.renderIframe(t,e)},getResourceDom:function(e){var t=document;return this.isConsoleIframeRender&&(t=this.iframeSelector.contentDocument),t.querySelector("#resource_"+e)},register:function(){var e=this;window.addEventListener("load",function(t){for(var r=document.querySelectorAll(".opc_resource"),o=0;o<r.length;o++){var n=r[o],i=n.getAttribute("data-sid");e.renderIframe(n,i)}}),e.receiveMessage()},renderIframe:function(e,t){if("done"===e.getAttribute("data-opc-status"))return!1;var r=document.createElement("iframe"),o=this.getCloseOpcTime(t),n=o?"c="+o+"&":"",i=this.isConsoleIframeRender?window.parent.OPC_RESOURCE_LIST:window.OPC_RESOURCE_LIST;r.frameborder=0,r.scrolling="no",r.style.border="0px",r.style.display="none",r.className="top-resource-iframe",r.width=e.getAttribute("data-width"),r.height=0,r.src="//"+this.actHost+"/act/resource/"+t+"?"+n+"p="+window.location.href+(this.is_preview?"&!preview":""),i[t]=r,e.appendChild(r),e.setAttribute("data-opc-status","done")},loadIframeHandle:function(e){if(!e)return!1;var t=OPC_RESOURCE_LIST[e],r=t.contentDocument,o=this.getResourceDom(e);if(!(r&&r.body&&r.body.children&&r.body.children[0]))return t.parentNode.removeChild(t),!1;t.height=o.getAttribute("data-height"),t.style.border="0px",t.style.display="block"},jsonp:function(e){if(!(e=e||{}).url||!e.callback)throw new Error("参数不合法");var t=("jsonp_"+Math.random()).replace(".",""),r=document.querySelectorAll("head")[0];e.data[e.callback]=t;var o=this.formatParams(e.data),n=document.createElement("script");r.appendChild(n),window[t]=function(o){r.removeChild(n),clearTimeout(n.timer),window[t]=null,e.success&&e.success(o)},n.src=e.url+"?"+o,e.time&&(n.timer=setTimeout(function(){window[t]=null,r.removeChild(n),e.fail&&e.fail({message:"超时"})},e.time))},formatParams:function(e){var t=[];for(var r in e)t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},getConsoleMessageResourceList:function(){var e=this;return new Promise(function(t,r){try{if(e.isGetResourceListLoading)return r(),!1;e.isGetResourceListLoading=!0;var o=(new Date).getTime(),n=localStorage.getItem("opc_console_message_resource");try{if(n){var i=JSON.parse(n);if(o-i.time<=6e4)return t(i.list),e.isGetResourceListLoading=!1,!1}}catch(e){}e.jsonp({url:"//"+e.opcHost+"/opc_resource/resource_public/resource_list",callback:"callback",time:2e5,data:{sid:e.consoleMessageSid,is_preview:e.is_preview?1:0},success:function(r){var o=r&&r.result&&r.result.resource_list&&r.result.resource_list[e.consoleMessageSid]||[];localStorage.setItem("opc_console_message_resource",JSON.stringify({list:o,time:(new Date).getTime()})),e.consoleMessageResourceList=o,e.isGetResourceListLoading=!1,e.clearUnExistCloseOpcStorage(o),t(o)},fail:function(){e.isGetResourceListLoading=!1}})}catch(e){throw new Error("拉取控制台活动消息运营位失败")}})},clearUnExistCloseOpcStorage:function(e){try{var t=localStorage.getItem("opc_resource_close"),r=t&&JSON.parse(t)||{},o=[],n=Object.keys(r)||[];if(n.length>0)return!1;for(var i=0;i<e.length;i++)o.push(e[i].sid);for(var a=0;a<n.length;a++)o.indexOf(n[a])<0&&delete r[n[a]];localStorage.setItem("opc_resource_close",JSON.stringify(r))}catch(e){throw new Error("清除资源位localstorage失败")}},addCloseOpcStorage:function(e){var t=localStorage.getItem("opc_resource_close"),r=t&&JSON.parse(t)||{};r[e]=(new Date).getTime(),localStorage.setItem("opc_resource_close",JSON.stringify(r))},getCloseOpcTime:function(e){var t=localStorage.getItem("opc_resource_close");return(t&&JSON.parse(t)||{})[e]},getPathname:function(){return this.isLtIE9?location.hash.replace("#",""):location.pathname},renderConsoleMessage:function(e,t){var r=this,n=r.currentPagePath;this.getConsoleMessageResourceList().then(function(i){for(var a="",c=0;c<i.length;c++){var s=i[c];if(s.regexp&&parseInt(s.status)===o){var l=new RegExp(s.regexp,"g"),u=n.match(l);u&&u.length>0&&(a=s.sid)}}if(!a)return!1;var d=e.querySelector("#resource_"+a),f=r.getPathname();if(d||n!==f)return!1;var m=t.firstChild,g=document.createElement("ins");g.setAttribute("data-sid",a),g.setAttribute("data-width","100%"),g.setAttribute("data-height","45"),g.className="opc_resource",g.id="resource_"+a,t.insertBefore(g,m),r.init(a)})},receiveMessage:function(){var e=this;(e.isConsoleIframeRender?e.iframeSelector.contentWindow:window).addEventListener("message",function(t){var r=t.origin,o="",n="";if(!(r.indexOf("qcloud.com")<0&&r.indexOf("cloud.tencent.com")<0)){try{var i=JSON.parse(t.data)||{};n=i.payload,o=i.type}catch(e){return!1}switch(o){case"opc_close_iframe":var a=n&&n.sid,c=window.OPC_RESOURCE_LIST[a];c.parentNode.removeChild(c),e.addCloseOpcStorage(a);break;case"opc_iframe_load_finish":a=n&&n.sid;e.loadIframeHandle(a);break;case"after-nmc-render":if(window.VERSION&&"zh"!==window.VERSION)break;e.isConsoleIframeRender=!1,e.isGetResourceListLoading=!1,e.iframeSelector=null,e.currentPagePath=e.getPathname();var s=document.querySelector("#appArea");e.renderConsoleMessage(document,s);break;case"after-iframe-render":case"opc_register_console_iframe_message":try{if(window.VERSION&&"zh"!==window.VERSION)break;e.isConsoleIframeRender=!0,e.isGetResourceListLoading=!1,e.currentPagePath=e.getPathname(),e.iframeSelector=document.querySelector(n.selector),setTimeout(function(){var t=e.iframeSelector&&e.iframeSelector.contentDocument&&e.iframeSelector.contentDocument.body;t&&e.renderConsoleMessage(e.iframeSelector.contentDocument,t)},200)}catch(e){}}}},!1)}};window.OPC_SDK={OPC:n};try{window.OPC_SDK.OPC.register()}catch(e){throw new Error("资源位注册失败")}}});